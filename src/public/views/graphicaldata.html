<html lang="en" dir="ltr">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title><%= title %></title>
  <link rel="shortcut icon" href="favicon.ico" />

  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/rangeslider.js/2.3.2/rangeslider.css" />

  <!-- font awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/fonts/FontAwesome.otf">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/fonts/fontawesome-webfont.eot">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/fonts/fontawesome-webfont.svg">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/fonts/fontawesome-webfont.ttf">
  <link rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/fonts/fontawesome-webfont.woff">

  <link rel="stylesheet" href="/views/graphicaldata.css" />

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/rangeslider.js/2.3.2/rangeslider.min.js"></script>
</head>

<body>
  <main>
    <div class="row row-with-margin">
      <div class="col">
        <div class="card bg-light">
          <div class="card-header">
            Prediction
          </div>
          <div class="card-body">
            <h5 class="card-title">How likely are you to be bankrupt</h5>
            <div class="card-text">
              <div id='wrapper'>
                <div class="card-text floatleft likely-text">Least Likely</div>
                <div class='smiley-green floatleft'>
                  <div class='left-eye'></div>
                  <div class='right-eye'></div>
                  <div class='smile'></div>
                </div>
                <div class='smiley-yellow floatleft'>
                  <div class='left-eye'></div>
                  <div class='right-eye'></div>
                  <div class='smile'></div>
                </div>
                <div class='smiley-red floatleft'>
                  <div class='left-eye'></div>
                  <div class='right-eye'></div>
                  <div class='smile'></div>
                </div>
                <div class="card-text floatleft likely-text">Most Likely</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row row-with-margin">
      <div class="col">
        <div class="card bg-light">
          <div class="card-header">
            Prevention Controls
          </div>
          <div class="card-body">
            <h5 class="card-title">Spending</h5>
            <div class="card-text">
              <input name="spending" id="spending-range" type="range" min="10000" max="120000" step="10" value="300">
              <div class="range">
                <small class="min pull-left">Min</small>
                <small class="max pull-right">Max</small>
              </div>
            </div>

            <h5 class="card-title">Credit</h5>
            <div class="card-text">
              <input name="credit" id="credit-range" type="range" min="10" max="1000" step="10" value="300">
              <div class="range">
                <small class="min pull-left">Min</small>
                <small class="max pull-right">Max</small>
              </div>
            </div>

            <h5 class="card-title">Wages</h5>
            <div class="card-text">
              <input name="wages" id="wages-range" type="range" min="10000" max="100000" step="10" value="300">
              <div class="range">
                <small class="min pull-left">Min</small>
                <small class="max pull-right">Max</small>
              </div>
            </div>

            <h5 class="card-title">Assets</h5>
            <div class="card-text">
              <input name="assets" id="assets-range" type="range" min="10000" max="500000" step="10" value="300">
              <div class="range">
                <small class="min pull-left">Min</small>
                <small class="max pull-right">Max</small>
              </div>
            </div>

          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col">
        <div class="card">
          <div class="card-header">
            <h1>With right steps, it's easy to recover from Bankruptcy</h1>

          </div>
          <div class="card-body">
            <center> <img
                src="https://technofaq.org/wp-content/uploads/2018/05/recovery-bankruptcy-road-sign-620x350.jpg" />
              <center>
          </div>
        </div>
      </div>
    </div>
  </main>



  <!-- <script type="text/javascript" src="/views/index.js"></script> -->
  <script>
    function getQuerystring(key) {
      var query = window.location.search.substring(1);
      //alert(query);
      var vars = query.split("&");
      for (var i = 0; i < vars.length; i++) {
        var pair = vars[i].split("=");
        if (pair[0] == key) {
          return pair[1];
        }
      }
    }

    var rawFormData = JSON.parse(decodeURIComponent(getQuerystring('formdata')))
    console.log('formdata', rawFormData)
    var add = (...values) => {
      let sum = 0;
      values.forEach(val => {
        try {
          if (!Number.isNaN(val)) {
            sum += Number.parseInt(val);
          }
        } catch (e) {
          // do nothing
        }
      });
      return sum;
    }
    let totalAssets = add([
      rawFormData.estimatedEquipmentCost,
      rawFormData.estimatedVehicleCost,
      rawFormData.otherAssets,
      rawFormData.totalInventoryValue,
      rawFormData.totalPropertyValue
    ]);
    let totalExpense = add([
      rawFormData.bills,
      rawFormData.cashOutflow,
      rawFormData.officeExpense,
      rawFormData.otherExpense
    ]);
    let totalIncome = add([rawFormData.cashInflow, rawFormData.profit]);
    let totalDebt = Math.ceil(rawFormData.debtAmount / rawFormData.debtTermInYears);


    {
      //custom slider javascript
      let $element = $('#spending-range');
      let $handle;
      $element
        .rangeslider({
          polyfill: false,
          onInit: function () {
            $handle = $(".rangeslider__handle", this.$range);
            updateHandle($handle[0], this.value);
          }
        })
        .on("input", function () {
          updateHandle($handle[0], this.value);
        });

      function updateHandle(el, val) {
        el.textContent = " " + "$" + val + " ";
      }
    }

    {
      //custom slider javascript
      let $element = $('#credit-range');
      let $handle;
      $element
        .rangeslider({
          polyfill: false,
          onInit: function () {
            $handle = $(".rangeslider__handle", this.$range);
            updateHandle($handle[0], this.value);
          }
        })
        .on("input", function () {
          updateHandle($handle[0], this.value);
        });

      function updateHandle(el, val) {
        el.textContent = " " + "$" + val + " ";
      }
    }

    {
      //custom slider javascript
      let $element = $('#wages-range');
      let $handle;
      $element
        .rangeslider({
          polyfill: false,
          onInit: function () {
            $handle = $(".rangeslider__handle", this.$range);
            updateHandle($handle[0], this.value);
          }
        })
        .on("input", function () {
          updateHandle($handle[0], this.value);
        });

      function updateHandle(el, val) {
        el.textContent = " " + "$" + val + " ";
      }
    }

    {
      //custom slider javascript
      let $element = $('#assets-range');
      let $handle;
      $element
        .rangeslider({
          polyfill: false,
          onInit: function () {
            $handle = $(".rangeslider__handle", this.$range);
            updateHandle($handle[0], this.value);
          }
        })
        .on("input", function () {
          updateHandle($handle[0], this.value);
        });

      function updateHandle(el, val) {
        el.textContent = " " + "$" + val + " ";
      }
    }


    $(document).ready(function () {
      //when slider changes, hide start message
      $("input").on("change", function () {
        $("#helper").fadeOut("slow");
      });
    });

  </script>

</html>